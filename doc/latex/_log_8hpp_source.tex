\hypertarget{_log_8hpp_source}{}\doxysection{Log.\+hpp}
\label{_log_8hpp_source}\index{MesumCore/Kernel/Log.hpp@{MesumCore/Kernel/Log.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef M\_LOG}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define M\_LOG}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <mutex>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <LogPolicies.hpp>}}
\DoxyCodeLine{11 \textcolor{keyword}{namespace }m}
\DoxyCodeLine{12 \{}
\DoxyCodeLine{13 \textcolor{comment}{//*****************************************************************************}}
\DoxyCodeLine{14 \textcolor{comment}{//*****************************************************************************}}
\DoxyCodeLine{15 \textcolor{comment}{//*****************************************************************************}}
\DoxyCodeLine{19 \textcolor{comment}{}}
\DoxyCodeLine{20 \textcolor{keyword}{namespace }logging}
\DoxyCodeLine{21 \{}
\DoxyCodeLine{23 \textcolor{keyword}{using} \mbox{\hyperlink{group___log_ga13f51627936471940ede5666fd047313}{ChannelID}} = uint64\_t;}
\DoxyCodeLine{25 \textcolor{keyword}{using} \mbox{\hyperlink{group___log_ga16bb065e762d9d22730e02ef41a8165f}{ChannelFilter}} = uint64\_t;}
\DoxyCodeLine{26 }
\DoxyCodeLine{28 \textcolor{keyword}{enum} \mbox{\hyperlink{group___log_gaf620be757be465af66aa69d08a4f5c8e}{SeverityType}}}
\DoxyCodeLine{29 \{}
\DoxyCodeLine{30     \mbox{\hyperlink{group___log_ggaf620be757be465af66aa69d08a4f5c8eabfecbf648c2deaa801f62e8dad71e361}{debug}} = 1, }
\DoxyCodeLine{31     \mbox{\hyperlink{group___log_ggaf620be757be465af66aa69d08a4f5c8ead564300fbfad44fd5b83f8ba9441ba5d}{error}},     }
\DoxyCodeLine{32     \mbox{\hyperlink{group___log_ggaf620be757be465af66aa69d08a4f5c8ea52b9f3af43a3f80e4a62548382b2c04b}{warning}}    }
\DoxyCodeLine{33 \};}
\DoxyCodeLine{34 }
\DoxyCodeLine{36 }
\DoxyCodeLine{39 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{40 \textcolor{keyword}{class }\mbox{\hyperlink{classm_1_1logging_1_1_logger}{Logger}}}
\DoxyCodeLine{41 \{}
\DoxyCodeLine{42    \textcolor{keyword}{public}:}
\DoxyCodeLine{44 }
\DoxyCodeLine{47     \mbox{\hyperlink{group___log_ga5dfda4dcd8b2bea3fc48a8852eb7edf8}{Logger}}(\textcolor{keyword}{const} std::string\& a\_name);}
\DoxyCodeLine{48 }
\DoxyCodeLine{50     \textcolor{keyword}{const} \mbox{\hyperlink{group___log_ga13f51627936471940ede5666fd047313}{ChannelID}} \mbox{\hyperlink{group___log_ga47287bdcab12bc333f8e978be79c0c75}{get\_newChannelID}}();}
\DoxyCodeLine{51 }
\DoxyCodeLine{53 }
\DoxyCodeLine{57     \textcolor{keywordtype}{void} \mbox{\hyperlink{group___log_gaddcfb00131aac4b1706bdd3b509353bb}{set\_filter}}(\textcolor{keyword}{const} \mbox{\hyperlink{group___log_ga16bb065e762d9d22730e02ef41a8165f}{ChannelFilter}} a\_filters);}
\DoxyCodeLine{58 }
\DoxyCodeLine{60 }
\DoxyCodeLine{64     \textcolor{keywordtype}{void} \mbox{\hyperlink{group___log_ga63b74328f6c81f7ee28958fad4bc874b}{disable\_channels}}(\textcolor{keyword}{const} \mbox{\hyperlink{group___log_ga16bb065e762d9d22730e02ef41a8165f}{ChannelFilter}} a\_filters);}
\DoxyCodeLine{65 }
\DoxyCodeLine{67 }
\DoxyCodeLine{71     \textcolor{keywordtype}{void} \mbox{\hyperlink{group___log_gaf8b43c36de390d048e69e3a7f9391ab0}{enable\_channels}}(\textcolor{keyword}{const} \mbox{\hyperlink{group___log_ga16bb065e762d9d22730e02ef41a8165f}{ChannelFilter}} a\_filters);}
\DoxyCodeLine{72 }
\DoxyCodeLine{74 }
\DoxyCodeLine{80     \textcolor{keyword}{template} <\mbox{\hyperlink{group___log_gaf620be757be465af66aa69d08a4f5c8e}{SeverityType}} severity, \textcolor{keyword}{typename}... Rest>}
\DoxyCodeLine{81     \textcolor{keywordtype}{void} \mbox{\hyperlink{group___log_gab06c4b9527f8da19747c470798fdd124}{print\_toChannel}}(uint64\_t a\_channel, Rest... a\_args);}
\DoxyCodeLine{83 }
\DoxyCodeLine{88     \textcolor{keyword}{template} <\mbox{\hyperlink{group___log_gaf620be757be465af66aa69d08a4f5c8e}{SeverityType}} severity, \textcolor{keyword}{typename}... Args>}
\DoxyCodeLine{89     \textcolor{keywordtype}{void} \mbox{\hyperlink{group___log_gac2c5d26d3b5edd3941f1c6930072a109}{print}}(Args... a\_args);}
\DoxyCodeLine{90 }
\DoxyCodeLine{92     \mbox{\hyperlink{group___log_ga65bf48423557daf6361e9273fa3cedcc}{\string~Logger}}();}
\DoxyCodeLine{93 }
\DoxyCodeLine{94    \textcolor{keyword}{private}:}
\DoxyCodeLine{96     std::string get\_time();}
\DoxyCodeLine{98     std::string get\_loglineHeader();}
\DoxyCodeLine{99 }
\DoxyCodeLine{101     std::stringstream m\_logStream;}
\DoxyCodeLine{103     LogPolicy* m\_policy;}
\DoxyCodeLine{105     std::mutex m\_mutexWrite;}
\DoxyCodeLine{106 }
\DoxyCodeLine{108     \textcolor{keywordtype}{void} print\_impl();}
\DoxyCodeLine{109 }
\DoxyCodeLine{111 }
\DoxyCodeLine{117     \textcolor{keyword}{template} <\textcolor{keyword}{typename} First, \textcolor{keyword}{typename}... Rest>}
\DoxyCodeLine{118     \textcolor{keywordtype}{void} print\_impl(First a\_parm1, Rest... a\_parm);}
\DoxyCodeLine{119 }
\DoxyCodeLine{120    \textcolor{keyword}{private}:}
\DoxyCodeLine{122     \textcolor{keywordtype}{unsigned} m\_lineNumber;}
\DoxyCodeLine{124     \mbox{\hyperlink{group___log_ga16bb065e762d9d22730e02ef41a8165f}{ChannelFilter}} m\_filter = -\/1;}
\DoxyCodeLine{126     \mbox{\hyperlink{group___log_ga13f51627936471940ede5666fd047313}{ChannelID}} m\_nextChannelID = 1;}
\DoxyCodeLine{127 \};}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{130 \textcolor{keyword}{template} <\mbox{\hyperlink{group___log_gaf620be757be465af66aa69d08a4f5c8e}{SeverityType}} severity, \textcolor{keyword}{typename}... Rest>}
\DoxyCodeLine{131 \textcolor{keywordtype}{void} \mbox{\hyperlink{group___log_gab06c4b9527f8da19747c470798fdd124}{Logger<LogPolicy>::print\_toChannel}}(uint64\_t a\_channel, Rest... a\_args)}
\DoxyCodeLine{132 \{}
\DoxyCodeLine{133     \textcolor{keywordflow}{if} (a\_channel \& m\_filter)}
\DoxyCodeLine{134     \{}
\DoxyCodeLine{135         print<severity>(a\_args...);}
\DoxyCodeLine{136     \}}
\DoxyCodeLine{137 \}}
\DoxyCodeLine{138 }
\DoxyCodeLine{139 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{140 \textcolor{keyword}{template} <\mbox{\hyperlink{group___log_gaf620be757be465af66aa69d08a4f5c8e}{SeverityType}} severity, \textcolor{keyword}{typename}... Args>}
\DoxyCodeLine{141 \textcolor{keywordtype}{void} \mbox{\hyperlink{group___log_gac2c5d26d3b5edd3941f1c6930072a109}{Logger<LogPolicy>::print}}(Args... a\_args)}
\DoxyCodeLine{142 \{}
\DoxyCodeLine{143     m\_mutexWrite.lock();}
\DoxyCodeLine{144     \textcolor{keywordflow}{switch} (severity)}
\DoxyCodeLine{145     \{}
\DoxyCodeLine{146         \textcolor{keywordflow}{case} \mbox{\hyperlink{group___log_ggaf620be757be465af66aa69d08a4f5c8eabfecbf648c2deaa801f62e8dad71e361}{SeverityType::debug}}: m\_logStream << \textcolor{stringliteral}{"{}<DEBUG> :"{}}; \textcolor{keywordflow}{break};}
\DoxyCodeLine{147         \textcolor{keywordflow}{case} \mbox{\hyperlink{group___log_ggaf620be757be465af66aa69d08a4f5c8ea52b9f3af43a3f80e4a62548382b2c04b}{SeverityType::warning}}: m\_logStream << \textcolor{stringliteral}{"{}<WARNING> :"{}}; \textcolor{keywordflow}{break};}
\DoxyCodeLine{148         \textcolor{keywordflow}{case} \mbox{\hyperlink{group___log_ggaf620be757be465af66aa69d08a4f5c8ead564300fbfad44fd5b83f8ba9441ba5d}{SeverityType::error}}: m\_logStream << \textcolor{stringliteral}{"{}<ERROR> :"{}}; \textcolor{keywordflow}{break};}
\DoxyCodeLine{149     \};}
\DoxyCodeLine{150     print\_impl(a\_args...);}
\DoxyCodeLine{151     m\_mutexWrite.unlock();}
\DoxyCodeLine{152 \}}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{155 \textcolor{keywordtype}{void} \mbox{\hyperlink{classm_1_1logging_1_1_logger}{Logger<LogPolicy>::print\_impl}}()}
\DoxyCodeLine{156 \{}
\DoxyCodeLine{157     m\_policy-\/>write(get\_loglineHeader() + m\_logStream.str());}
\DoxyCodeLine{158     m\_logStream.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{159 \}}
\DoxyCodeLine{160 }
\DoxyCodeLine{161 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{162 \textcolor{keyword}{template} <\textcolor{keyword}{typename} First, \textcolor{keyword}{typename}... Rest>}
\DoxyCodeLine{163 \textcolor{keywordtype}{void} Logger<LogPolicy>::print\_impl(First a\_parm1, Rest... a\_parm)}
\DoxyCodeLine{164 \{}
\DoxyCodeLine{165     m\_logStream << a\_parm1;}
\DoxyCodeLine{166     print\_impl(a\_parm...);}
\DoxyCodeLine{167 \}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{170 std::string Logger<LogPolicy>::get\_time()}
\DoxyCodeLine{171 \{}
\DoxyCodeLine{172     time\_t       raw\_time;}
\DoxyCodeLine{173     time(\&raw\_time);}
\DoxyCodeLine{174 }
\DoxyCodeLine{175     \textcolor{keyword}{struct }tm * timeInfo;}
\DoxyCodeLine{176 \textcolor{preprocessor}{    \#ifdef M\_WIN32}}
\DoxyCodeLine{177     timeInfo = localtime(\&raw\_time);}
\DoxyCodeLine{178 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{179     timeInfo = localtime(\&raw\_time);}
\DoxyCodeLine{180 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{181     Char buffer [80];}
\DoxyCodeLine{182     strftime(buffer, 80, \textcolor{stringliteral}{"{}\%d/\%m/\%y -\/ \%H/\%M/\%S"{}}, timeInfo);}
\DoxyCodeLine{183 }
\DoxyCodeLine{184     std::string time\_str(buffer);}
\DoxyCodeLine{185     \textcolor{keywordflow}{return} time\_str.substr(0, time\_str.size() -\/ 1);}
\DoxyCodeLine{186 \}}
\DoxyCodeLine{187 }
\DoxyCodeLine{188 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{189 std::string Logger<LogPolicy>::get\_loglineHeader()}
\DoxyCodeLine{190 \{}
\DoxyCodeLine{191     std::stringstream header;}
\DoxyCodeLine{192     header.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{193     header.fill(\textcolor{charliteral}{'0'});}
\DoxyCodeLine{194     header.width(7);}
\DoxyCodeLine{195     header << m\_lineNumber++ << \textcolor{stringliteral}{"{} < "{}} << get\_time() << \textcolor{stringliteral}{"{} -\/ "{}};}
\DoxyCodeLine{196     header.fill(\textcolor{charliteral}{'0'});}
\DoxyCodeLine{197     header.width(7);}
\DoxyCodeLine{198     header << clock() << \textcolor{stringliteral}{"{} > \string~ "{}};}
\DoxyCodeLine{199     \textcolor{keywordflow}{return} header.str();}
\DoxyCodeLine{200 \}}
\DoxyCodeLine{201 }
\DoxyCodeLine{202 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{203 \mbox{\hyperlink{group___log_ga5dfda4dcd8b2bea3fc48a8852eb7edf8}{Logger<LogPolicy>::Logger}}(\textcolor{keyword}{const} std::string\& a\_name)}
\DoxyCodeLine{204 \{}
\DoxyCodeLine{205     m\_nextChannelID = 1;}
\DoxyCodeLine{206     m\_filter        = -\/1;}
\DoxyCodeLine{207     m\_lineNumber    = 0;}
\DoxyCodeLine{208     m\_policy        = \textcolor{keyword}{new} LogPolicy;}
\DoxyCodeLine{209     \textcolor{keywordflow}{if} (!m\_policy)}
\DoxyCodeLine{210     \{}
\DoxyCodeLine{211         \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{212             \textcolor{stringliteral}{"{}LOGGER: Unable to create the logger instance"{}});}
\DoxyCodeLine{213     \}}
\DoxyCodeLine{214     m\_policy-\/>open\_ostream(a\_name);}
\DoxyCodeLine{215 \}}
\DoxyCodeLine{216 }
\DoxyCodeLine{217 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{218 \mbox{\hyperlink{group___log_ga65bf48423557daf6361e9273fa3cedcc}{Logger<LogPolicy>::\string~Logger}}()}
\DoxyCodeLine{219 \{}
\DoxyCodeLine{220     \textcolor{keywordflow}{if} (m\_policy)}
\DoxyCodeLine{221     \{}
\DoxyCodeLine{222         m\_policy-\/>close\_ostream();}
\DoxyCodeLine{223         \textcolor{keyword}{delete} m\_policy;}
\DoxyCodeLine{224     \}}
\DoxyCodeLine{225 \}}
\DoxyCodeLine{226 }
\DoxyCodeLine{227 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{228 \textcolor{keyword}{const} \mbox{\hyperlink{group___log_ga13f51627936471940ede5666fd047313}{ChannelID}} \mbox{\hyperlink{group___log_ga47287bdcab12bc333f8e978be79c0c75}{Logger<LogPolicy>::get\_newChannelID}}()}
\DoxyCodeLine{229 \{}
\DoxyCodeLine{230     \textcolor{comment}{// TODO : Fix this ID generation problem}}
\DoxyCodeLine{231     \textcolor{keyword}{static} \mbox{\hyperlink{group___log_ga13f51627936471940ede5666fd047313}{ChannelID}} nextChannelID = 1;}
\DoxyCodeLine{232     \textcolor{keywordflow}{return} nextChannelID <<= 1;}
\DoxyCodeLine{233 \}}
\DoxyCodeLine{234 }
\DoxyCodeLine{235 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{236 \textcolor{keywordtype}{void} \mbox{\hyperlink{group___log_gaddcfb00131aac4b1706bdd3b509353bb}{Logger<LogPolicy>::set\_filter}}(\textcolor{keyword}{const} \mbox{\hyperlink{group___log_ga16bb065e762d9d22730e02ef41a8165f}{ChannelFilter}} a\_filters)}
\DoxyCodeLine{237 \{}
\DoxyCodeLine{238     m\_filter = a\_filters;}
\DoxyCodeLine{239 \}}
\DoxyCodeLine{240 }
\DoxyCodeLine{241 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{242 \textcolor{keywordtype}{void} \mbox{\hyperlink{group___log_ga63b74328f6c81f7ee28958fad4bc874b}{Logger<LogPolicy>::disable\_channels}}(\textcolor{keyword}{const} \mbox{\hyperlink{group___log_ga16bb065e762d9d22730e02ef41a8165f}{ChannelFilter}} a\_filters)}
\DoxyCodeLine{243 \{}
\DoxyCodeLine{244     m\_filter = m\_filter \& \string~a\_filters;}
\DoxyCodeLine{245 \}}
\DoxyCodeLine{246 }
\DoxyCodeLine{247 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LogPolicy>}
\DoxyCodeLine{248 \textcolor{keywordtype}{void} \mbox{\hyperlink{group___log_gaf8b43c36de390d048e69e3a7f9391ab0}{Logger<LogPolicy>::enable\_channels}}(\textcolor{keyword}{const} \mbox{\hyperlink{group___log_ga16bb065e762d9d22730e02ef41a8165f}{ChannelFilter}} a\_filters)}
\DoxyCodeLine{249 \{}
\DoxyCodeLine{250     m\_filter = m\_filter | a\_filters;}
\DoxyCodeLine{251 \}}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \}  \textcolor{comment}{// namespace logging}}
\DoxyCodeLine{254 \}  \textcolor{comment}{// namespace m}}
\DoxyCodeLine{255 \textcolor{preprocessor}{\#endif }\textcolor{comment}{//M\_LOG}}

\end{DoxyCode}
